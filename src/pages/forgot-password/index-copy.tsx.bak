// import { API_FORGOT_PASSWORD, API_RESET_PASSWORD } from '@/constants/apis';
// import { get } from 'http';
// // import { get } from 'http';
// import { useSearchParams } from 'next/navigation';
// import { useState, useEffect } from 'react';

// export default function ForgotPassword() {
//     const searchParams = useSearchParams()
//     const emailFromQuery = searchParams.get('email') || ''
//     const [getURL, setGetURL] = useState<string | null>(null)
  
//     const [step, setStep] = useState(1)
//     const [form, setForm] = useState({
//       email: emailFromQuery,
//       new_password: ''
//     })
//     const [isSuccess, setIsSuccess] = useState(false)
  
//     const [message, setMessage] = useState<string | null>(null)
//     const [loading, setLoading] = useState<boolean>(false)
  
//     // Effect to set step 2 if email exists in the query params
//     useEffect(() => {
//       console.log('Email', emailFromQuery)
//       console.log('URL', getURL)
//       if (emailFromQuery) {
//         // getResetURL()
//         setStep(2)
//         setForm((prevForm) => ({ ...prevForm, email: emailFromQuery }))
//       }
//     }, [emailFromQuery])

//     const getResetURL = async () => {
//       try {
//         const response = await fetch(API_RESET_PASSWORD, {
//           method: 'POST',
//           headers: {
//             'Content-Type': 'application/json',
//           },
//           body: JSON.stringify({ email: form.email }),
//         });
  
//         if (!response.ok) {
//           const responseJson = await response.json();
//           throw new Error(responseJson.error || 'Failed to fetch reset URL.');
//         }
  
//         const responseJson = await response.json();
//         setGetURL(responseJson.message); // Update state
//         console.log('Reset URL:', responseJson.message);
//         return responseJson.message;
//       } catch (error) {
//         console.error('Error fetching reset URL:', error);
//         setMessage('Failed to fetch reset URL. Please try again.');
//       }
//     };
    
//     // Handle input change
//     const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {
//       const { name, value } = e.target
//       setForm((prevForm) => ({ ...prevForm, [name]: value }))
//     }
  
//     const handleSubmit = async (e: React.FormEvent) => {
//       e.preventDefault()
//       setLoading(true)
//       setMessage(null)
  
//       try {
//         let response
  
//         if (step === 1) {
//           // Send OTP request
//           response = await fetch(API_FORGOT_PASSWORD, {
//             method: 'POST',
//             headers: {
//               'Content-Type': 'application/json'
//             },
//             body: JSON.stringify({ email: form.email })
//           })
  
//           if (!response.ok) {
//             const responseJson = await response.json()
//             throw new Error(responseJson.error)
//           }

//           const resetURL = await getResetURL(); // Fetch the reset URL
//           if (resetURL) {
//             setMessage('Reset password link sent to your email.');
//             setStep(2); // Move to the next step
//           }
//         } else {
//           // OTP verification step
//           console.log('URL',getURL)
//           if (!getURL) {
//             throw new Error('Verification URL is not set.');
//           }

//           const token = getURL.split('/').pop();
          
//           response = await fetch(getURL, {
//             method: 'POST',
//             headers: {
//               'Content-Type': 'application/json',
//             },
//             body: JSON.stringify({
//               token: token,
//               new_password: form.new_password,
              
//             }),
//           });
          
//           if (!response.ok) {
//             const responseJson = await response.json()
//             throw new Error(responseJson.error || 'Failed to URL link.')
//           }
  
//           setMessage('Password has been reset. You can now log in.')
//           setIsSuccess(true)
//         }
//       } catch (error) {
//         setMessage(`An error occurred: ${error}`)
//       } finally {
//         setLoading(false)
//       }
//     }
  
//     return (
//       <div className='w-full h-[calc(100vh-479px)] bg-gray-100 flex items-center justify-center'>
//         <div className='w-0 lg:w-1/2'></div>
//         <div className='p-6 rounded w-full lg:w-1/2 max-w-md'>
//           {isSuccess ? (
//             <>
//               <h1 className='text-4xl font-medium text-green-600 mb-4 tracking-widest'>
//                 SUCCESS!
//               </h1>
//               <p className='text-sm font-medium text-gray-700 mb-4 tracking-widest'>
//                 Your password has been reset.
//               </p>
//               <button
//                 onClick={() => (window.location.href = '/login')}
//                 className='w-full bg-buttonBlue hover:bg-textBlue text-white py-2 rounded transition-all duration-300'
//               >
//                 Go to Login
//               </button>
//             </>
//           ) : step === 1 ? (
//             <>
//               <h1 className='text-4xl font-medium text-textBlue mb-4 tracking-widest'>
//                 INPUT <br /> YOUR EMAIL
//               </h1>
//               <p className='text-sm font-medium text-textBlue mb-4 tracking-widest'>
//                 A reset link will be sent to your email.
//               </p>
//               <form onSubmit={handleSubmit}>
//                 <input
//                   type='email'
//                   name='email'
//                   placeholder='Email'
//                   value={form.email}
//                   onChange={handleChange}
//                   required
//                   className='w-full p-3 border mb-4 focus:ring-2 focus:ring-buttonBlue focus:outline-none'
//                 />
//                 <button
//                   type='submit'
//                   className='w-full bg-buttonBlue hover:bg-textBlue text-white py-2 rounded transition-all duration-300'
//                   disabled={loading}
//                 >
//                   {loading ? 'Loading...' : 'Send OTP'}
//                 </button>
//               </form>
//               {message && (
//                 <p className='text-center mt-4 text-sm text-red-500'>{message}</p>
//               )}
//             </>
//           ) : (
//             <>
//               <h1 className='text-4xl font-medium text-textBlue mb-4 tracking-widest'>
//                 INSERT <br /> PASSWORD
//               </h1>
//               <p className='text-sm font-medium text-textBlue mb-4 tracking-widest'>
//                 Please enter your new password.
//               </p>
//               <form onSubmit={handleSubmit}>
//                 <input
//                   type='text'
//                   name='new_password'
//                   placeholder='Enter your OTP'
//                   value={form.new_password}
//                   onChange={handleChange}
//                   required
//                   className='w-full p-3 border mb-4 focus:ring-2 focus:ring-buttonBlue focus:outline-none'
//                 />
//                 <button
//                   type='submit'
//                   className='w-full bg-buttonBlue hover:bg-textBlue text-white py-2 rounded transition-all duration-300'
//                   disabled={loading}
//                 >
//                   {loading ? 'Loading...' : 'Change Password'}
//                 </button>
//                 <button
//                   type='button'
//                   onClick={() => setStep(1)}
//                   className='w-full mt-2 bg-gray-400 text-white py-2 rounded transition-all duration-300'
//                   disabled={loading}
//                 >
//                   Resend Email
//                 </button>
//               </form>
//               {message && (
//                 <p className='text-center mt-4 text-sm text-red-500'>{message}</p>
//               )}
//             </>
//           )}
//         </div>
//       </div>
//     )
// }
// // function getResetURL() {
// //   throw new Error('Function not implemented.');
// // }

